
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Need for Air</title>
  <meta name="author" content="Need for Air">

  
  <meta name="description" content="Since the Facebook&#8217;s IPO fiasco, many commenters (mainly bloggers and Wall Street analysts)
seem keen to say that Facebook is really not worth &hellip;">
  


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://needforair.com/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <script type="text/javascript" src="http://use.typekit.com/zcp2xbp.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/NeedForAir" rel="alternate" title="Need for Air" type="application/atom+xml">
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts 
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33856769-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body   >

	<div class="container">

		<div class="four columns">
  			<nav role="navigation"><ul class="title">
</ul>
<ul class="main-navigation">

  <li class="other"><a href="/">Blog</a></li>
  <li class="other"><a href="/about-us">About Us</a></li>
  <li class="other"><a href="/blog/archives">Archives</a></li>
  <li class="other"><a target="_blank" href="http://tldr.io">tldr.io</a></li>
  <li class="other"><a href="/our-book">Our Book</a></li>
</ul>

<ul class="subscription" data-subscription="rss email">
  <li class="other"><a href="http://feeds.feedburner.com/NeedForAir"
    rel="subscribe-rss" title="subscribe via RSS">Subscribe by RSS</a></li>
  
    <li><a href="http://feedburner.google.com/fb/a/mailverify?uri=NeedForAir" rel="subscribe-email"
      title="subscribe via email">Subscribe by Email</a></li>
  
</ul>
  



</nav>
        <aside class="sidebar">
          
            <section>
  <h1 class="tweets">Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/08/22/upstart-and-node/">What To Use Upstart (And Other Supervisors) For</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/09/jenkins-in-production/">How We Use Jenkins for Continuous Deployment</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/01/new-era-continuous-client/">Enhancing the User Experience With a Continuous Client</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/25/start-your-kids-coding-very-soon/">Start Your Kids Coding Very Soon</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/19/starting-startup-not-principal-concern/">Starting a Startup Should Not Be The Primary Concern</a>
      </li>
    
  </ul>
</section>

<section id="twitter">
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/NeedForAir" class="twitter-follow-button" data-show-count="false">Follow @NeedForAir</a>
  
</section>

<section>
  <h1 class="tweets">Read our Book</h1>
  <a href="http://leanpub.com/startupflow"><img
    src="http://titlepages.leanpub.com/startupflow/small?1335536785"
    alt="Startup Flow"></a>
</section>

          



        </aside>    
  	</div>
    

    <header class="twelve columns" role="banner">
    
<hgroup>
  <h1>Need for Air</h1>
  
    <h2>Solving the Information Overload Problem</h2>
  
</hgroup>

    </header>


  	<div id="main" class="twelve columns">
	    <div id="content">
	      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/29/facebook-ipo/">Some Positive Thoughts About the Facebook IPO</a></h1>
    
    
      <p class="meta">
    
        <time datetime="2012-05-29T12:00:00+02:00" pubdate><span class='month'>May</span> <span class='day'>29</span> <span class='year'>2012</span></time>
        | 
  

<span class="byline author vcard"><span class="fn">Louis Chatriot</span></span>

    
      </p>
    
  </header>




  <div class="entry-content"><p>Since the Facebook&#8217;s IPO fiasco, many commenters (mainly bloggers and Wall Street analysts)
seem keen to say that Facebook is really not worth that much. I don&#8217;t agree, because I think
that trying to determine Facebook&#8217;s value is premature.</p>

<p><a href="http://www.flickr.com/photos/kevinkrejci/7218818780/" target="_blank"><img alt="Facebook headquarters" src="http://farm6.staticflickr.com/5320/7218818780_9507a57365_n.jpg" height="320px" width="320px"></a>
<em>CC Licence - Author: <a href="http://www.flickr.com/photos/kevinkrejci/">Kevin Krejci</a></em></p>

<h2>Facebook&#8217;s IPO Surely Didn&#8217;t Go Well</h2>

<p>It&#8217;s a well-known fact, but it always makes me cringe: I still don&#8217;t
understand why <a href="http://www.huffingtonpost.com/daniel-dicker/facebook-retail-investors_b_1549602.html">well-connected people would have the right to buy shares
at a better price than &#8220;normal&#8221; investors</a>.
But it&#8217;s a fact: if you are one of the underwriters&#8217; best clients, you
will be able to purchase the stock at its opening price (in Facebook&#8217;s
case $38 per share). You will even able to purchase the stock before the IPO, at a lower price than $38.
If you&#8217;re not, you will have to wait. In this IPO,
retail (&#8220;normal&#8221;) investors had to <a href="http://www.cnbc.com/id/47043815//">wait until the stock traded at $42 a
share</a> before being able to buy. On
top of this common IPO problem, key information was known to insiders but not
shared with all investors, which is why <a href="http://news.cnet.com/8301-1023_3-57439918-93/facebook-zuckerberg-sued-over-ipo/">Facebook has been sued</a>.
In that regard, Facebook&#8217;s IPO surely didn&#8217;t go well.</p>

<h2>Nobody Knows Facebook&#8217;s True Worth</h2>

<p>But even though it didn&#8217;t go well, I am puzzled to read so many negative
comments about Facebook itself. All kinds of people, from bloggers to
Wall Street analyst seem to forget that Facebook still is a
multi-billion dollars business. What I think many fail to see is that,
in fact, nobody can seriously pretend to know Facebook&#8217;s true worth. It
could be <a href="http://cdixon.org/2012/05/15/facebooks-business-model/">worth a lot more, or a lot less</a>.
This is different from a traditional company, for which everybody knows
the business model (think GM, Total or even Apple). In Facebook&#8217;s case,
we don&#8217;t know how they&#8217;re going to monetize their 900M users. Is it
going to be through advertising? A premium version? Will they be able to
make money on mobile platforms? We (at least I) don&#8217;t know. A Facebook share is a lottery
ticket, whose value today has nothing to do with its value tomorrow. I for one am
no Facebook expert, so instead of trying to guess the future, I will
just sit back, relax, and see how the Facebook team continues to innovate.</p>
</div>
  
  
        
          <a href="/blog/2012/05/29/facebook-ipo/#disqus_thread">Comments</a>
        


  
    <div class="sharing">
  
    
    <a href="http://twitter.com/share" class="twitter-share-button" data-text="Some Positive Thoughts About the Facebook IPO" data-url="http://needforair.com/blog/2012/05/29/facebook-ipo/" data-via="NeedForAir" data-counturl="http://needforair.com/blog/2012/05/29/facebook-ipo/" >Tweet</a>
    
  
  
</div>

  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/21/history-is-repeating-itself-from-online-poker-to-startups/">History Is Repeating Itself: From Online Poker to Startups</a></h1>
    
    
      <p class="meta">
    
        <time datetime="2012-05-21T12:49:00+02:00" pubdate><span class='month'>May</span> <span class='day'>21</span> <span class='year'>2012</span></time>
        | 
  

<span class="byline author vcard"><span class="fn">Stanislas Marion</span></span>

    
      </p>
    
  </header>




  <div class="entry-content"><p><a href="http://i38.tinypic.com/34telxc.jpg" target="_blank"><img alt="Graph of Isildur1's winnings against durrrr" src="http://i38.tinypic.com/34telxc.jpg" height="450px" width="600px"></a>
<em>Image courtesy of <a href="http://highstakesdb.com">High Stakes DB</a></em></p>

<p>Poker is often used as an analogy for <a href="http://www.avc.com/a_vc/2012/03/from-the-archives-the-poker-analogy.html">investing</a>
or daytrading. The rationale being that there is money at stake, some randomness involved and people are actually winning
in all these &#8220;games&#8221;. However in this blogpost I don&#8217;t want to focus on
these elements but rather on how the startup ecosystem is going through
exactly the same thing the online poker ecosystem went through a few
years ago. In
order to clear the air, I&#8217;ve started playing poker when I was in
college/grad school, and won mid 6 figures playing heads-up cash games in quite a short time
starting from a free 50 bucks, rising
pretty fast once I &#8220;got it&#8221;. But I was never even close to a top
player like <a href="http://www.highstakesdb.com/profiles/jungleman12.aspx">jungleman12</a> or <a href="http://www.highstakesdb.com/profiles/pokerstars/Sauce123.aspx">Sauce123</a> who made millions by the
time they were 21. The
highest I played good players was 1000nl
with some drunken stunts much higher (these didn&#8217;t go too well). <em>For those
who don&#8217;t know, 1000nl means $5/$10 blinds no limit, meaning you usually
play with a $1000+ stack).</em></p>

<h2>A Brief History of Online Poker</h2>

<h3>Early On</h3>

<p>Online poker started in
<a href="http://en.wikipedia.org/wiki/Online_poker">1998</a> but I was still
playing Lego(TM) then. However, from what I gathered during my insanely
long hours reading poker blogs and
<a href="http://forumserver.twoplustwo.com">twoplustwo</a>, it was pretty awesome,
nobody had a clue what they were doing, and a few smart guys made
millions at 16 years old because they were a bit more creative, ruthless
and self-controlled than the others. All the winners were completely
self-taught, information about winning strategies, psychological
pitfalls were very scarce, and theory was completely absent of most
winning poker players&#8217; thought processes.</p>

<h3>Poker Reaches For Everyone</h3>

<p>I entered the online poker world belatedly, around 2008-9. At this point, poker training sites such
as <a href="http://cardrunners.com">Cardrunners</a>, <a href="http://leggopoker.com">Leggopoker</a>, <a href="http://deucescracked.com">DeucesCracked</a>
already existed and were growing pretty rapidly. These sites would
charge you a measly $30 a month for incredible insights from some very
good poker players, and probably enabled thousands of people to earn a
ton of money they would have never hoped for. In Europe,
<a href="http://pokerstrategy.com">Pokerstrategy</a> was even more daring, and
decided to give a free $50 (it was really free, no CC required or any
other bullshit) to anyone asking for it that passed a 20-question quizz
(and that surely didn&#8217;t weed out anybody but the laziest chumps). It
worked phenomenally well from the rumors I heard.
The point is, online poker had matured to the stage at which people were
now making money coaching it (I coached small stakes for $200/hour, but high-stakes coaching rates were closer to $1-2k/hour), teaching it via video, writing and selling <a href="http://www.dailyvariance.com/poker-books/let-there-be-range/">books</a>
about it for seemingly obscene <a href="http://bestpokercoaching.com/shop/product/the-blue-book-of-poker-by-shootaa-aka-reid-young/">prices</a>,
blogging about it, etc. It was really an incredible thing. Now anyone
with a bit of self-control, normal intelligence and a good deal of
dedication could become a winning poker player and live the dream.
Someone once said on Two Plus Two that it was probably the only place on
earth where a 16-year old would feel bad about making only $100k in a
year and complain that he had been unlucky.</p>

<h3>The Level Goes Up Globally</h3>

<p>However, it made the global level go up steeply and quickly.
It got harder than ever to get past micro-stakes as most people there
were actually trying to win, watching videos, getting coaching. They
were still terrible, but much better than the people playing the same stakes 5
years earlier.
The same held true at every stake, and at mid-stakes, people were really
starting to get pretty good, high stakes was reserved to elite
hard-working players. By the time I got the bankroll to comfortably play
mid-stakes, it had become really tough. Fish would get eaten alive
extremely quickly and a lot of hitherto winning players started breaking
even, becoming <a href="http://forumserver.twoplustwo.com/32/beginners-questions/being-rakeback-pro-389038/">rakeback pros</a>, <a href="http://forumserver.twoplustwo.com/29/news-views-gossip/remember-h-llingol-700116/">went broke</a> or quit the game altogether.</p>

<h3>Good Players Start Accelerators</h3>

<p>A few good players saw how their students went from donk to very good
quickly, and how little money they made from it (relatively). So they
started devising group-staking programs, formed stables of young eager
horses that wanted to benefit from their insights and threw them enough
money to get them started. I&#8217;m pretty sure this went very well for a few
elite players, but terribly wrong for other people with lower quality
insights that just tried to follow the money.</p>

<h3>People Go The Easiest Way When It Gets Too Hard</h3>

<p>So a lot of people learned to game select better (some would say
<a href="http://www.kokev.in/2010/12/19/pokers-tragedy-of-the-commons-bumhunting/">bumhunt</a>), which means choosing
profitable tables where there are weaker players. Some (including
myself), took it to the extreme by only playin heads up (one-to-one)
with significantly worse players than themselves at stakes they cared
about. This is not wrong in and of itself, anyone&#8217;s entitled to his
choices, and some people were after the money, not the glory. This
highly annoyed the greatest players though, because they couldn&#8217;t find
anyone to play with.</p>

<h3>Stakes Rise</h3>

<p>Stakes also gradually rose. There was a time when 400nl was the highest
online stake offered, then it went to 2knl and when I first played, the highest stakes
offered were already 10knl. A few months later, 100knl tables were <a href="http://www.highstakesdb.com/548-railheaven-5001000-nl-holdem-6-seats-new-table.aspx">introduced</a>
on Full Tilt Poker (rip).</p>

<h3>Established Top Players Help Each Other</h3>

<p>As available stakes rose from 2knl to 100knl, swings became huge and few
players were properly bankrolled for those stakes. High stakes players
started taking a piece of one another all the time, leading to confusing
and some time embarassing or devastating scenarios, although some
probably did very well at staking and swapping percentages.</p>

<h3>People Say It&#8217;s Now Impossible to Become a Legend</h3>

<p>People were saying rising to high stakes let alone
nosebleeds was impossible, and yet a few people did it, through sheer
hard work, passion and probably talent. The most legendary of all is
<a href="http://www.pokertableratings.com/fulltilt-player-search/jungleman12">Jungleman</a>.</p>

<h2>So How Does the Startup World Compare?</h2>

<p>I&#8217;m obviously very new to the startup world, having started my own only 2
months ago. (Yeah while at Stanford, I foolishly (or brilliantly) chose to
play 25nl instead of going to my entrepreneurship classes, ah the
allure of quick money). I won&#8217;t talk about the early days because I
really haven&#8217;t read enough about it and most of you probably know more
about it than I do.</p>

<h3>Startup Are For Everyone</h3>

<p>But I feel like I&#8217;m entering the startup world at roughly the same stage
I entered the online poker world. The early goldrush is over, meaning
it&#8217;s not about being at the right place at the right time any more. The
starting, building, growing processes are getting theorized and written
about everywhere on the internet. <a href="http://news.ycombinator.com">Hacker
News</a> is the equivalent of <a href="http://forumserver.twoplustwo.com">Two Plus
Two</a>.
People are writing books, <a href="http://theleanstartup.com/book">The Lean Startup</a>,
The Startup Manual and a
slew of others come to
mind (although these are much more affordable than poker books). Hell
even we wrote a <a href="http://leanpub.com/startupflow">book</a>!
People are making <a href="http://www.udemy.com/search?q=startup">videos</a>, <a href="http://www.skillshare.com/Course-Launching-Your-Startup-Idea/2055575858">selling</a>
<a href="http://www.skillshare.com/Employee-Equity-Overview/890814338">classes</a> about
<a href="http://www.skillshare.com/site/search?q=startup&amp;city=nyc">startups</a> on
<a href="http://skillshare.com">Skillshare</a>.</p>

<p>Even the core engineering competencies are given away for free by sites
such as <a href="http://udacity.com">Udacity</a> or <a href="http://coursera.org">Coursera</a>.</p>

<p>And this is really great. It opens opportunities to millions of people
that didn&#8217;t grow up in the Silicon Valley to gain invaluable insights
into what made successes and failures, it makes people dream and
motivates people, like I used to dream reading Cole South&#8217;s <a href="http://cts687.livejournal.com/">blog</a> (a fascinating read about his lightning-fast rise to legend status).
Now I read stories about the Paypal Mafia, Zuckerberg, Drew Houston,
Brian Chesky, Kevin Rose or Kevin Systrom. Again the stakes are not the
same, and it&#8217;s incredible to be able to dream like that.</p>

<h3>Good Players Start Accelerators</h3>

<p>Y Combinator and so many others start forming stables of promising
teams that they stake and give insights to. The best do make a lot of
money from it and produce some of today&#8217;s rising stars. All the
less selective followers probably won&#8217;t be as lucky.</p>

<h3>The Level Goes Up Globally</h3>

<p>However what this means is that the global level is also rising, and
rising quickly and globally. More and more talented people now know that
they can apply their skills and time to doing a startup, and the
standards for traction, quality of product, quality of team, revenues
are going up before you can be considered for an investment.</p>

<p>A lot more people are now competing, not only for funding but also for
spots in Google results pages, Google Ads rankings, app-stores rankings,
share of time, share of mind, etc.</p>

<h3>People Go The Easiest Way When It Gets Too Hard</h3>

<p>A lot of ideas are now X as a service, or X for Y, where you just
replace X and Y by an existing service, company, market or geography. Sometimes that might
a genuinely great idea, but I feel that this way of thinking is just
never going to yield to real breakthroughs, and more importantly it is
going to lead to ton of mediocre, unambitious ideas. However, if we
follow the poker analogy, it is very likely the best way to have enjoy
very decent monetary success and to build a thriving business. Shooting
for the stars is harder than ever, as was rising to nosebleed stakes in
2009.</p>

<h3>Stakes Rise</h3>

<p>We&#8217;re reading about it every other day on Techcrunch, Twitter and tech
blogs, valuations are through the roof, it&#8217;s a bubble, blablabla. I have
no idea if it&#8217;s a bubble or not but the facts are here: it&#8217;s not
uncommon now to talk of a $3million seed round or a $10million series A
round and $50million series B (100knl does seem small compared to these
numbers). Facebook is going to be the biggest tech
IPO in history. Services are now reaching millions or even billions of
users.</p>

<h3>Established Top Players Help Each Other</h3>

<p>Established entrepreneurs, are taking pieces of each other&#8217;s companies
all the time as most of them are very active angel investors from what I
can read on Techcrunch, just like high-stakes players would stake each
other. Not sure how this will end for most of them, if we follow the poker analogy,
probably badly in a lot of cases. However I&#8217;m sure these investments are
dealt with in a more professional way than 18 year-old kids simply chatting on AIM and transfering hundreds
of thousands of $ to one another just by clicking a few buttons
on a poker site, which led to a lot of confusion and scams.</p>

<h3>People Say It&#8217;s Now Impossible to Become a Legend</h3>

<p><a href="https://twitter.com/#!/Jason">Jason Calacanis</a>&#8217;s last newsletter was
about <em>The Age of Excellence</em>. In his words, <em>There&#8217;s no room left in 2012 for average, or even good, products.</em>
Meaning that if you want to make it to the top, you know need to battle
as hard as ever, work extremely hard (not necessarily in a long hours
way) and consistently outsmart your competition. And the rise of those
who do everything right will be meteoric (Instagram rings a bell?) like
jungleman12&#8217;s rise was in online poker.</p>

<h2>Conclusion</h2>

<p>So I feel like history is really repeating itself for me, except this
time I won&#8217;t settle for bumhunting or an easy way out.
Also I actually will make something useful instead of
just taking people&#8217;s money by just clicking buttons at 4am in my
underpants with pizza boxes and bottle of cokes surrounding me.
Hopefully the startup world won&#8217;t crash like online poker did
on <a href="http://www.pokernews.com/news/2011/04/a-closer-look-at-online-poker-black-friday-indictment-10224.htm">Black Friday</a>.</p>
</div>
  
  
        
          <a href="/blog/2012/05/21/history-is-repeating-itself-from-online-poker-to-startups/#disqus_thread">Comments</a>
        


  
    <div class="sharing">
  
    
    <a href="http://twitter.com/share" class="twitter-share-button" data-text="History is Repeating Itself: from Online Poker to Startups" data-url="http://needforair.com/blog/2012/05/21/history-is-repeating-itself-from-online-poker-to-startups/" data-via="NeedForAir" data-counturl="http://needforair.com/blog/2012/05/21/history-is-repeating-itself-from-online-poker-to-startups/" >Tweet</a>
    
  
  
</div>

  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/15/go-behind-opinion-polls/">Behind Opinion Polls: Fundamentals and Reliability</a></h1>
    
    
      <p class="meta">
    
        <time datetime="2012-05-15T20:12:00+02:00" pubdate><span class='month'>May</span> <span class='day'>15</span> <span class='year'>2012</span></time>
        | 
  

<span class="byline author vcard"><span class="fn">Charles Miglietti</span></span>

    
      </p>
    
  </header>




  <div class="entry-content"><p><em>This article is quite technical and requires a mathematical background
for a comprehensive understanding. All
technical points have a reference to the corresponding Wikipedia&#8217;s article for further
explanations.</em></p>

<p>We are in an election time in France. Everyday news is rythmed by
polls. <em>Nicolas Sarkozy is falling from 2% in today&#8217;s poll from IPSOS</em>,
<em>Francois Hollande slipped below 33% after the crisis</em> etc&#8230; Everybody
seems to give a lot of credit to these polls forgetting most of the time
that they are just statistical estimations of the reality. But how reliable are they?
The results for the first round of the french presidential election
seemed to surprise so many people and medias that it pushed me to dig
into my maths lessons from college to look for some scientific
explanation if any.</p>

<p><a href="http://www.flickr.com/photos/ownipics/4875527294/"><img src="http://farm5.staticflickr.com/4073/4875527294_cacbf9601e_n.jpg" alt="Polling" /></a></p>

<h2>Organizing the Opinion Poll</h2>

<p>Opinion polls tend to estimate the percentage of people who will vote
for a given candidate. Polling Institutes want to produce accurate polls
but they can&#8217;t poll a too big sample as it would be time consuming and
expensive.</p>

<p>They choose a <a href="http://en.wikipedia.org/wiki/Sampling_(statistics)">representative sample</a>
of the population and ask them for whom they plan to vote. The responses
 are assumed <a href="http://en.wikipedia.org/wiki/Independence_(probability_theory)">independant</a>.</p>

<p>Once collected, how do we use them build an estimate of the votes and what is the
precision of this estimate?</p>

<p>The <em>natural and logical</em> estimate is to take the
<a href="http://en.wikipedia.org/wiki/Sample_mean">sample mean</a> as an estimator. How do we
justify such an estimate and what is its precision? We&#8217;ll see that what
sounds like common sense has a strong mathematical justification.</p>

<h2>Building the Estimate</h2>

<p>We are in a situation where we have <em>n</em> people</p>

<div markdown="0">
\[ X_1, X_2,&#8230;X_n\]
</div>


<p>who can choose between <em>k</em> candidates. We define the variable</p>

<div markdown="0">
\[ \delta_{i,j} \]
</div>


<p>which is equal to <em>1</em> if person <em>i</em> votes for candidate
<em>j</em> and <em>0</em> if not.</p>

<p>The real vote intentions we want
to estimate are noted :</p>

<div markdown="0">
\[ \pi_1, \pi_2,&#8230;\pi_k\]
</div>


<p>with the constraint:</p>

<div markdown="0">
\[ \sum_j^k \pi_j = 1 \]
</div>


<p>The probability to observe the result of the polling is:</p>

<div markdown="0">
\[ p_{\pi}(X_1, X_2,&#8230;,X_n) = \prod_i^n p_{\pi} (X_i)\]
</div>


<p>as the <em>n</em> people are chosen independantly.</p>

<div markdown="0">
\[ \prod_i^n p_{\pi} (X_i) = \prod_j^k \prod_i^n \pi_j^{\delta_{i,j}} =
  \prod_j^k \pi_j^{n_j}\]
</div>


<p>where</p>

<div markdown="0">
\[ n_j = \sum_i^n \delta_{i,j}\]
</div>


<p>The strategy we adopt is, given the <em>n</em> people, to maximize this
propability of observing the output. Maximizing this propability is the
same as minimizing the <em>-log</em> of the probability as <em>-log</em> is a convex
function. With this transformation, the computation of the extremum is
much easier as the product becomes a sum.</p>

<div markdown="0">
\[ max[p_{\pi}(X_1, X_2,&#8230;,X_n)] = min[(-log(p_{\pi}(X_1,
        X_2,&#8230;,X_n))] = min[ \sum_j^k n_j log(\pi_j) ]\]
</div>


<p>To find the minimum with the above constraint we can use the
<a href="http://en.wikipedia.org/wiki/Lagrange_multiplier">Lagrangian
multiplier</a> and just
minimize:</p>

<div markdown="0">
\[ \sum_j^k n_j log(\pi_j) + \lambda(\sum_j^k \pi_j -1)\]
</div>


<p>which gives us the estimates which minimize the above function</p>

<div markdown="0">
\[ \hat{\pi_1}, \hat{\pi_2},&#8230;\hat{\pi_k}\]
</div>




<div markdown="0">
\[ \hat{\pi_j} = \frac{n_j}{n} \]
</div>


<p>We just justified the use of the empirical mean as an estimate of the true
mean given a set of observations using <a href="http://en.wikipedia.org/wiki/Maximum_a_posteriori_estimation">maximum a posteriori
estimation</a>.</p>

<h2>Reliability</h2>

<p>Given the estimator, which level of trust can we give it? How close is
are the estimated and true values. The <a href="http://en.wikipedia.org/wiki/Law_of_large_numbers">law of large numbers</a>
tells us that when the size of the sample goes to infinity the estimated
value tends to the true value. But in reality there is not an infinity
of people who get polled. Usually just a few thousands are. From one
sample to the other the estimator won&#8217;t be the same. So how confident are the polling
institutes in their estimations? The reliability of the estimator
depends on the statistical fluctuations of the estimate around the true
value.</p>

<p>The <a href="http://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a> tells us that
the random variables (<em>m</em> is the true mean and <em>sigma</em> the variance):</p>

<div markdown="0">
\[ \frac{\hat{\pi_j} -nm}{\sigma \sqrt{n}} \] 
</div>


<p><a href="http://en.wikipedia.org/wiki/Convergence_in_distribution#Convergence_in_distribution">converge in distribution</a>
to a normal random variable with mean 0 and variance 1. From here we
have the approximation:</p>

<div markdown="0">
\[ P(|\hat{\pi_j} - \pi_j| \leq \epsilon) = P(\frac{\sqrt{n}|\hat{\pi_j} - \pi_j|}{\sqrt{p(1-p)}} \leq \frac{\sqrt{n}\epsilon}{\sqrt{p(1-p)}}) \approx \int_{-a}^{a} g(x)dx\]
</div>


<p>where <em>g</em> is the density of the normal distribution and</p>

<div markdown="0">
\[ a = \frac{\sqrt{n}\epsilon}{\sqrt{p(1-p)}} \]
</div>


<p>from which we can write</p>

<div markdown="0">
\[ \epsilon = \frac{a\sqrt{p(1-p)}}{\sqrt{n}} \]
</div>


<p>So given a threshold of confidence <em>t</em>  we can build a interval of
confidence where we can state with <em>t%</em> of confidence that the true
value is within this interval:</p>

<div markdown="0">
\[ I_t = [\hat{\pi}_{j,n} - \frac{a_t}{2\sqrt{n}}, \hat{\pi}_{j,n} + \frac{a_t}{2\sqrt{n}}] \]
</div>


<p>where</p>

<div markdown="0">
\[ \int_{-a_t}^{a_t} g(x)dx = t\]
</div>


<p>The value for <em>a</em> can be found in a computation table. For <em>t</em> equal to
<em>95%</em> the value of <em>a</em> is <em>1.96</em> which gives us for the interval where there
is <em>95%</em> of chance that the true value is:</p>

<div markdown="0">
\[ I_t = [\hat{\pi}_{j,n} - \frac{1}{\sqrt{n}}, \hat{\pi}_{j,n} + \frac{1}{\sqrt{n}}] \]
</div>


<h2>In Practice</h2>

<p>With the simple slider and graphic you can see by yourself the influence
of the number of people polled for an opinion poll. The box represents
the <em>95%</em> interval of confidence that means there is <em>95%</em> of chance that the
true vote intention is within this interval.</p>

<div id='PollingNumericApplication' style="text-align:center;"></div>


<script src="http://d3js.org/d3.v2.min.js"></script>


<div style="text-align:center;">
  <label style="width:200px;float:left;"> Size of population</label>
  <input  id='polling-slider' style="width:160px;margin-left:-300px;" type="range" min="500" max="5000" value="1000"/>
  <span id="polling-range">1000</span><br/>
  <label style="width:200px;float:left;"> Estimated Mean </label>
  <input style="text-align:center;width:30px;" id='polling-mean' type="text"  value="35"/> <br/>
</div>


<script >
// Suppose there is currently one div with id "d3TutoGraphContainer" in the DOM
// We append a 600x300 empty SVG container in the div
var pollingChart = d3.select("#PollingNumericApplication").append("svg").attr("width", "600").attr("height", "150");

// Create the bar chart which consists of ten SVG rectangles, one for each piece of data
var pollingIntervals = pollingChart.selectAll('rect').data([1000])
                 .enter().append('rect')
                 .attr("stroke", "none").attr("fill", "rgb(7, 130, 180)")
                 .attr("x", function(d) {return 300 - 2580*1.96/Math.sqrt(d);})
                 .attr("y", function(d, i) { return 25 * i; } )
                 .attr("width", function(d) { return 5160*1.96/Math.sqrt(d); } )
                 .attr("height", "20");
var pollingTickers = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1];


var pollinggetX = function(d) { return 50 + 500 * d; };

var pollingLines = pollingChart.selectAll('.tickers').data(pollingTickers)
                 .enter().append('rect')
                 .classed('tickers', true)
                 .attr("fill", "steelblue")
                 .attr("x", pollinggetX)
                 .attr("y", 60)
                 .attr("width", 1)
                 .attr("height", 10);

var pollingLabels = pollingChart.selectAll('.tickerlabels').data(pollingTickers)
                  .enter().append('text')
                  .classed('tickerlabels', true)
                  .attr("x", pollinggetX)
                  .attr("y", 100)
                  .attr("width", 1)
                  .attr("height", 10)
                  .attr('text-anchor', 'middle')
                  .text(function(d) { return '' + (30+d * 10) + '%'; } );

$('#polling-slider').on('change',function ()
{
  var newValue = parseInt(this.value, '10');
  pollingIntervals.data([newValue])
       .attr("x", function(d) {return 300 - 2580*1.96/Math.sqrt(d);})
       .attr("width", function(d) { return 5160*1.96/Math.sqrt(d); } );
    document.getElementById('polling-range').innerHTML = newValue; 
});
$('#polling-mean').on('change',function (){

  var newValue = parseInt(this.value, '10');
 pollingLabels = pollingChart.selectAll('.tickerlabels').remove();
 pollingLabels = pollingChart.selectAll('.tickerlabels').data(pollingTickers)
                  .enter().append('text')
                  .classed('tickerlabels', true)
                  .attr("x", pollinggetX)
                  .attr("y", 100)
                  .attr("width", 1)
                  .attr("height", 10)
                  .attr('text-anchor', 'middle')
                  .text(function(d) { return '' + (newValue - 5+d * 10) + '%'; } );
});
</script>


<h2>Conclusion</h2>

<p>This quick refresher on opinion polls should remind us that opinion polls
can be quite far from reality. And there is one variable that I
didn&#8217;t take into account: there are people who don&#8217;t dare
to name the true candidate they plan to vote for. This is especially
true for extremist votes and explains <a href="http://www.guardian.co.uk/world/2012/apr/22/marine-le-pen-french-election">why we can experience such a
discrepancy between the estimations and the true results of one
election</a>.</p>
</div>
  
  
        
          <a href="/blog/2012/05/15/go-behind-opinion-polls/#disqus_thread">Comments</a>
        


  
    <div class="sharing">
  
    
    <a href="http://twitter.com/share" class="twitter-share-button" data-text="Behind Opinion polls: Fundamentals and Reliability" data-url="http://needforair.com/blog/2012/05/15/go-behind-opinion-polls/" data-via="NeedForAir" data-counturl="http://needforair.com/blog/2012/05/15/go-behind-opinion-polls/" >Tweet</a>
    
  
  
</div>

  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/09/d3-tutorial/">Introduction to D3: Build an Animated Graph in 19 Lines of Code</a></h1>
    
    
      <p class="meta">
    
        <time datetime="2012-05-09T12:05:00+02:00" pubdate><span class='month'>May</span> <span class='day'>09</span> <span class='year'>2012</span></time>
        | 
  

<span class="byline author vcard"><span class="fn">Louis Chatriot</span></span>

    
      </p>
    
  </header>




  <div class="entry-content"><p>The goal of this tutorial is to give an introduction to <a href="http://d3js.org/">d3.js</a> by using the example of a simple
animated bar chart. Before anything else, let&#8217;s take a look at it.
Click on any bar of this chart -you can do it multiple times- to see what happens!</p>

<div id='d3TutoGraphContainer'></div>


<script type="text/javascript" src="http://d3js.org/d3.v2.min.js"></script>


<script type="text/javascript">
// Suppose there is currently one div with id "d3TutoGraphContainer" in the DOM
// We append a 600x300 empty SVG container in the div
var chart = d3.select("#d3TutoGraphContainer").append("svg").attr("width", "600").attr("height", "300");

// Create the bar chart which consists of ten SVG rectangles, one for each piece of data
var rects = chart.selectAll('rect').data([1 ,4, 5, 6, 24, 8, 12, 1, 1, 20])
                 .enter().append('rect')
                 .attr("stroke", "none").attr("fill", "rgb(7, 130, 180)")
                 .attr("x", 0)
                 .attr("y", function(d, i) { return 25 * i; } )
                 .attr("width", function(d) { return 20 * d; } )
                 .attr("height", "20");

// Transition on click managed by jQuery
rects.on('click', function() {
    // Generate randomly a data set with 10 elements
    var newData = [];
    for (var i=0; i<10; i+=1) { newData.push(Math.floor(24 * Math.random())); }

    // Generate a random color
    var newColor = 'rgb(' + Math.floor(255 * Math.random()) +
                     ', ' + Math.floor(255 * Math.random()) +
                     ', ' + Math.floor(255 * Math.random()) + ')';

    rects.data(newData)
         .transition().duration(2000).delay(200)
         .attr("width", function(d) { return d * 20; } )
         .attr("fill", newColor);
  });
</script>


<p>Pretty neat, huh? You can see the gist of a standalone working HTML
<a href="https://gist.github.com/2601571">here</a>. We&#8217;re going to go through the
javascript part which consists of 19 lines of javascript (comments and
blank lines excluded of course), on top of the <a href="http://d3js.org/">d3 library</a>.
d3 (for <strong>d</strong>ata <strong>d</strong>riven <strong>d</strong>ocument) is a <strong>low-level javascript
framework that allows you to easily bind data to elements of the
DOM and manipulate them</strong>. Even though d3&#8217;s most frequent use is for
drawing charts, <strong>it is not a visualization library</strong>, it just handles
data binding and data-driven DOM manipulation, which is arguably the
boring -even though not the easiest- part, and lets you focus on content creation.</p>

<p>So <strong>why</strong> use a low-level framework to draw graphs when so many integrative chart
libraries exist out there (<a href="http://www.highcharts.com/">Highcharts</a> , <a href="https://developers.google.com/chart/">Google Chart Tools</a>  &#8230;)? Precisely because
it is <strong>low-level</strong>. That means you have to put in more effort upfront, but in
return you gain <strong>total control of your data visualization</strong>, you are more flexible,
and you can freely use the full power of existing technologies (CSS3, HTML5, SVG &#8230;)
to visualize data however you want (as a graph or otherwise).</p>

<p>This example uses SVG. It&#8217;s not a problem if you are not used to it, as it is very
straightforward, but you may still want to check <a href="https://developer.mozilla.org/en/SVG">the MDN tutorial on SVG</a>.
Now let&#8217;s take a look at the code for the chart:</p>

<div><script src='https://gist.github.com/2601663.js?file='></script>
<noscript><pre><code>// Suppose there is currently one div with id &quot;d3TutoGraphContainer&quot; in the DOM
// We append a 600x300 empty SVG container in the div
var chart = d3.select(&quot;#d3TutoGraphContainer&quot;).append(&quot;svg&quot;).attr(&quot;width&quot;, &quot;600&quot;).attr(&quot;height&quot;, &quot;300&quot;);

// There is no rectangle on which we can bind data in the SVG container
// All the data will thus be bound in the enter
var rects = chart.selectAll('rect').data([1 ,4, 5, 6, 24, 8, 12, 1, 1, 20])
                 .enter().append('rect')                           // Add a rectangle for each data in the enter
                 .attr(&quot;stroke&quot;, &quot;none&quot;).attr(&quot;fill&quot;, &quot;steelblue&quot;) // All rectangles are blue with no borders
                 .attr(&quot;x&quot;, 0)
                 .attr(&quot;y&quot;, function(d, i) { return 25 * i; } )
                 .attr(&quot;width&quot;, function(d) { return 20 * d; } )
                 .attr(&quot;height&quot;, &quot;20&quot;);

rects.on('click', function() {
                    rects.transition().duration(2000).delay(200)
                         .attr(&quot;width&quot;, function(d) { return 500 * Math.random(); } )
                  });</code></pre></noscript></div>


<p>The first thing you should notice is that d3 uses method chaining. Every d3 function
returns a d3 object on which you can apply another d3 function. This makes for code that
reads almost like a sentence, for example the first line would be &#8220;select the div with id
<em>d3TutoGraphContainer</em> and create a SVG element with width 600 and height 300&#8221;.</p>

<h2>Selecting elements</h2>

<p>This is the core of D3: selecting elements of the DOM, and doing stuff with them.
D3 uses CSS3 selectors, also used by jQuery. You can select nodes by tag name, css class or id.<br/>
<code>d3.select(selector)</code> selects the first node matching <em>selector</em> and returns a d3 object
containing this node on which you can apply any d3 function.<br/>
<code>d3.selectAll(selector)</code> selects all nodes matching <em>selector</em> and returns a d3
object containing these nodes on which you can apply any d3 function. So in our example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Select the element with id &#39;d3TutoGraphContainer&#39;</span>
</span><span class='line'><span class="c1">// and store it in the variable &#39;chart&#39;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#d3TutoGraphContainer&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can also apply <code>select</code> to an existing selection, to select among the children
of the existing selection. This is usually useful to ensure that all d3 manipulations
will take place in a container div (&#8216;d3TutoGraphContainer&#8217; in our example):</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Select all SVG rectangles children of this div</span>
</span><span class='line'><span class="c1">// At this point this selection is empty but all inserted</span>
</span><span class='line'><span class="c1">// rectangles will populate it so that we can reference</span>
</span><span class='line'><span class="c1">// it later in the &#39;click&#39; callback</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">chart</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Inserting in and removing from the DOM</h2>

<p>d3 provides functions for inserting in and removing from the DOM.
As usual, these functions apply to d3 selections.<br/>
<strong>Note :</strong> you may ask why use these functions when we can use jQuery for example.
The answer is simple : even though you could do it, d3&#8217;s DOM manipulation functions are
designed to work with other d3 function, so you can use method chaining. It is
thus easier to use d3 and only d3 to build a data-driven document.</p>

<h3>Inserting in the DOM</h3>

<p><code>selection.append(tag)</code> appends an element of the specified <em>tag</em> as the last child
of each element of <em>selection</em>. In our example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Appends a &lt;svg&gt;&lt;/svg&gt; element inside</span>
</span><span class='line'><span class="c1">// the d3TutoGraphContainer div (selection</span>
</span><span class='line'><span class="c1">// has only one element)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#d3TutoGraphContainer&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Inserts on rectangle for each piece of data</span>
</span><span class='line'><span class="c1">// in the enter() selection (more explanations</span>
</span><span class='line'><span class="c1">// in the data binding paragraph)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">chart</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span> <span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is another way to insert elements in the DOM: <code>selection.insert(name, before)</code>
which inserts, as a child of every element in <em>selection</em>, an element of type <em>name</em>
before the first element selectable by the CSS selector <em>before</em>. This is useful to
control which SVG elements appear on top of the others (the last one in the page is on top).</p>

<h3>Removing from the DOM</h3>

<p>Removing all the elements from a selection is done with the <code>d3.remove()</code> function,
like this : <code>selection.remove()</code>. This is often used with the <code>exit()</code> function, also covered in
the &#8220;Binding data&#8221; section below.</p>

<h2>Binding data</h2>

<p>Binding data is the core of d3. The <code>d3.data</code> function binds data to the selection
to which it was applied, and returns three selections:</p>

<ul>
<li>The <em>update</em> selection: all the DOM elements from the selection to which we could bind data</li>
<li>The <em>enter</em> selection: the &#8216;surplus&#8217; (if any) data for which there was no DOM element</li>
<li>The <em>exit</em> selection: all the &#8216;surplus&#8217; (if any) DOM elements for which there was no data</li>
</ul>


<p>Of course, at least one of the <em>enter</em> and the <em>exit</em> has to be empty, both are if the data
has the same size as the selection. In our example we use <code>d3.data()</code> twice:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// #1: use of the enter selection</span>
</span><span class='line'><span class="c1">// The update will be empty as the selection</span>
</span><span class='line'><span class="c1">// is empty, the enter will contain all 10</span>
</span><span class='line'><span class="c1">// elements</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">chart</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span> <span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">enter</span><span class="p">().</span><span class="nx">doSomething</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// #2: use of the update selection</span>
</span><span class='line'><span class="c1">// At this point, rects contains the 10 rectangles, and newData contains</span>
</span><span class='line'><span class="c1">// 10 elements, so the update contains all elements, the enter and the</span>
</span><span class='line'><span class="c1">// exit are empty</span>
</span><span class='line'><span class="nx">rects</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">newData</span><span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">doSomething</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>d3.data()</code> directly returns the <em>update</em> so you can immediately do something on it (that&#8217;s our #2).
If you want to work on the <em>enter</em> or the <em>exit</em> you need to call <code>d3.enter()</code> or <code>d3.exit()</code> on
the update (that&#8217;s our #1).</p>

<h2>Modifying the DOM according to the data</h2>

<p>Now it&#8217;s time to use d3 for what it was designed: manipulating the DOM using the data.
We can modify any attribute of an element, CSS classes, properties, text and even inner HTML.</p>

<h3>Modifying attributes: d3.attr</h3>

<p>Calling <code>selection.attr(attribute, value)</code> modifies (and creates if it doesn&#8217;t exist)
the attribute <em>attribute</em> to give it the value <em>value</em> for every element of <em>selection</em>.
<em>value</em> can be a function of data and element index, as in our example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">chart</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span> <span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>                 <span class="c1">// Add a rectangle for each data in the enter</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                 <span class="c1">// All rectangles are steelblue with no borders</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;stroke&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;rgb(70, 130, 180)&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                 <span class="c1">// All rectangles are 0px from the left of</span>
</span><span class='line'>                 <span class="c1">// the container</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>                 <span class="c1">// First rectangle (i = 0) is 0px from the</span>
</span><span class='line'>                 <span class="c1">// top of the container, second onf (i = 1)</span>
</span><span class='line'>                 <span class="c1">// is 25px from the top and so on</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">25</span> <span class="o">*</span> <span class="nx">i</span><span class="p">;</span> <span class="p">}</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                 <span class="c1">// Rectangles&#39; width is 20 times the bound data</span>
</span><span class='line'>                 <span class="c1">// The first one is 20px wide, the second</span>
</span><span class='line'>                 <span class="c1">// one 80px and so on</span>
</span><span class='line'>                 <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">20</span> <span class="o">*</span> <span class="nx">d</span><span class="p">;</span> <span class="p">}</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                 <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other modifications</h3>

<p>As this is not a reference, I won&#8217;t show all functions that modify elements.
You can look into the <a href="https://github.com/mbostock/d3/wiki/API-Reference">d3 reference</a>
to learn how to modify classes with <code>d3.classed</code>, properties with <code>d3.property</code> and style with <code>d3.style</code>.</p>

<h2>Transitions</h2>

<p>The last, and maybe the most impressive piece of d3 is the transitions engine.
As we saw in the previous section, d3 enables us to modify any attribute instantly.
It can also transition number attributes (e.g. position in pixels, width etc)
from their old to their new value smoothly, using the <code>transition()</code>, <code>duration()</code>
and <code>delay()</code> functions. You apply this function to any selection and then apply
the new attributes, which will be transitioned. In our example, we transition the width
of the bars to animate the graph:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// If we didn&#39;t use transitions, the graph would change immediately</span>
</span><span class='line'><span class="nx">rects</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">newData</span><span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="mi">20</span> <span class="o">*</span> <span class="nx">d</span><span class="p">;</span> <span class="p">}</span> <span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="nx">newColor</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Simply adding using d3.transition() between new data binding and</span>
</span><span class='line'><span class="c1">// attribute modification and the change becomes graceful</span>
</span><span class='line'><span class="nx">rects</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">newData</span><span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">transition</span><span class="p">().</span><span class="nx">duration</span><span class="p">(</span><span class="mi">2000</span><span class="p">).</span><span class="nx">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="mi">20</span> <span class="o">*</span> <span class="nx">d</span><span class="p">;</span> <span class="p">}</span> <span class="p">)</span>
</span><span class='line'>     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="nx">newColor</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Cool, isn&#8217;t it ? The use of <code>delay()</code> is optional, as you can imagine. The <code>transition()</code> function can
transition number attributes, but can also understand when a
string contains numbers, and smoothly transition the number parts of the string -that&#8217;s how I
built the rainbow transition in the example at the top of this article. It also understands some specific
types of strings, for example colors (i.e. it can transition from &#8216;steelblue&#8217; to &#8216;red&#8217;). Visit the <a href="http://d3js.org/">d3.js website</a> for more on this!</p>

<h3>Advanced transitions</h3>

<p>What I explained are just the default, basic transition engine, which works very well.
You may need to customize your transition interpolation function, tween or easing function.
For example, I did that to animate a line chart (which is a SVG path).</p>

<h2>Conclusion</h2>

<p>With this tutorial, you should know more than enough to create awesome custom
graphs or data visualizations. Since you have total control, you can even create this kind
of <a href="http://bl.ocks.org/1256572">crazy animations</a>!</p>

<p>Also, it is the only way I found to build smooth animated graphs on the iPad, other libraries such
as Highcharts were too slow.</p>
</div>
  
  
        
          <a href="/blog/2012/05/09/d3-tutorial/#disqus_thread">Comments</a>
        


  
    <div class="sharing">
  
    
    <a href="http://twitter.com/share" class="twitter-share-button" data-text="Introduction to d3: Build an Animated Graph in 19 Lines of Code" data-url="http://needforair.com/blog/2012/05/09/d3-tutorial/" data-via="NeedForAir" data-counturl="http://needforair.com/blog/2012/05/09/d3-tutorial/" >Tweet</a>
    
  
  
</div>

  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1 class="tweets">Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/08/22/upstart-and-node/">What To Use Upstart (And Other Supervisors) For</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/09/jenkins-in-production/">How We Use Jenkins for Continuous Deployment</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/01/new-era-continuous-client/">Enhancing the User Experience With a Continuous Client</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/25/start-your-kids-coding-very-soon/">Start Your Kids Coding Very Soon</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/19/starting-startup-not-principal-concern/">Starting a Startup Should Not Be The Primary Concern</a>
      </li>
    
  </ul>
</section>

<section id="twitter">
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/NeedForAir" class="twitter-follow-button" data-show-count="false">Follow @NeedForAir</a>
  
</section>

<section>
  <h1 class="tweets">Read our Book</h1>
  <a href="http://leanpub.com/startupflow"><img
    src="http://titlepages.leanpub.com/startupflow/small?1335536785"
    alt="Startup Flow"></a>
</section>

  
</aside>

	    </div>
  	</div>
  
  <footer role="contentinfo"  class="sixteen columns"><center>
<p class="credit">
  <a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png" /></a><br />
   <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Need for Air</span> by.
   <a xmlns:cc="http://creativecommons.org/ns#" href="http://needforair.com" property="cc:attributionName" rel="cc:attributionURL">Need for Air</a> is licensed under a
   <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.<br>
   <span class="credit">Contributors include <a href="http://twitter.com/#!/stanmarion">Stanislas Marion</a>, <a href="http://twitter.com/#!/charlesmigli">Charles Miglietti</a> and <a href="http://twitter.com/#!/louisChatriot">Louis Chatriot</a></span><br>
   <span class="credit">Powered by <a href="http://github.com">GitHub</a>, <a href="https://github.com/imathis/octopress">Octopress</a>, &amp; <a href="https://github.com/dhgamache/Skeleton">Skeleton</a></span>.<br>
   <span class="credit">Thanks to <a href="http://ryandeussing.com">Ryan Deussing</a> for the theme.</span>
</p>
</center>

</footer>
  
  

<script type="text/javascript">
      var disqus_shortname = 'needforair';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>






  <script >
    $("header")
    .css('cursor', 'pointer')
    .click( function () {
      window.location = "/";
    });
  </script>

<script>
  jQuery.noConflict()('li.other').hover (
    function () {
    jQuery.noConflict()(this).toggleClass("current-menu-item")
  });
</script>

</body>
</html>


	</div> <!-- container -->
